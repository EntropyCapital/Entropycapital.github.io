<!DOCTYPE html>
<html lang="en" class="antialiased">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Production | D.A.G. FILM</title>

  <!-- Favicon -->
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png" />

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Feather Icons -->
  <script src="https://unpkg.com/feather-icons"></script>

  <!-- Flatpickr date-picker -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css" />
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/plugins/confirmDate/confirmDate.css" />
  <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/plugins/confirmDate/confirmDate.js"></script>

  <!-- Stripe.js -->
  <script src="https://js.stripe.com/v3/"></script>

  <!-- MailerLite Embed Styles -->
  <link rel="stylesheet" href="/css/mailerlite.css" />
</head>

<body class="bg-gray-900 text-white flex flex-col min-h-screen">
  <!-- Sticky Nav -->
  <nav class="sticky top-0 z-50 bg-gray-900 bg-opacity-90 backdrop-blur-md flex items-center justify-between px-6 py-4">
    <a href="/index.html">
      <img src="/images/logo-small.png" alt="D.A.G. FILM Logo" class="h-10"/>
    </a>
    <button class="open-booking px-5 py-2 bg-blue-600 hover:bg-blue-500 rounded-full font-semibold">
      Schedule a Call
    </button>
  </nav>

  <!-- Footer -->
  <footer class="bg-gray-900 text-gray-400 py-6 mt-auto">
    <!-- footer content omitted for brevity -->
  </footer>

  <!-- Booking Logic & Scripts -->
  <script>
    let selectedSlot = null;
    flatpickr('#slotpicker', {
      enableTime: true,
      minDate: 'today',
      plugins: [new confirmDatePlugin({ confirmText: 'OK' })],
      onChange: dates => {
        selectedSlot = dates[0].toISOString();
        document.getElementById('confirm-btn').disabled = false;
      }
    });

    // Initialize Stripe with your real Publishable Key
    const stripe = Stripe('pk_live_51RJdkFKPt2aVTNdugck2GhfHEkokeBJRZ2fs7Q8dXkClth26CKHfgoONU3hqocJhrLWr9zXmQm1qTVecWKQOoqny00Esz4Kvhf');

    document.querySelectorAll('.open-booking').forEach(btn =>
      btn.addEventListener('click', () => document.getElementById('booking-modal').classList.remove('hidden'))
    );
    document.getElementById('close-booking').onclick = () =>
      document.getElementById('booking-modal').classList.add('hidden');

    document.getElementById('confirm-btn').onclick = async () => {
      const email = document.getElementById('email-input').value;
      const res = await fetch('/api/create-checkout-session', {
        method: 'POST',
        headers: {'Content-Type':'application/json'},
        body: JSON.stringify({ email, slot: selectedSlot })
      });
      const { id } = await res.json();
      console.log('Redirecting to Checkout with session:', id);
      stripe.redirectToCheckout({ sessionId: id }).then(result => {
        if (result.error) alert(result.error.message);
      });
    };

    feather.replace({ 'stroke-width': 2 });
  </script>
</body>
</html>
